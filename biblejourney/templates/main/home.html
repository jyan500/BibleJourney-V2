{% extends 'layouts/layout.html' %}
{% block content %}
	<script>
		{% if verses %}
			$(document).ready(function(){
				$('#home-prev-div').click(function(){
					window.location.href = '/verses/chapter?search_param={{book}} {{chapter - 1}}';	
				});
				$('#home-next-div').click(function(){
					window.location.href = '/verses/chapter?search_param={{book}} {{chapter + 1}}';	
				});
				$('#preference-submit').click(function(){
					let paragraph_mode = $('#paragraph-mode').prop('checked') ? '1' : '0'
					window.location.href = '/verses/chapter?search_param={{book}} {{chapter}}&paragraph_mode=' + paragraph_mode;	
				});
			});
		{% endif %}
	</script>
	<div class = "content-section">	
		<form method = "GET" action = "{{ url_for('main.verses') }}">
			<div class = "form-group">
				{{ form.verse.label(class="form-control-label") }}	
				{% if form.verse.errors %}
					{{ form.verse(class="form-control form-control-lg is-invalid") }}	
					<div class = "invalid-feedback">
						{% for error in form.verse.errors %}
							<span>{{ error }}</span>
						{% endfor %}
					</div>
				{% else %}
					{{ form.verse(class="form-control form-control-lg", placeholder="Examples: John 3, John 3:16, John 3:17-19 ... ") }}	
				{% endif %}
			</div>
			<div class = "form-group">
				{{ form.submit(class="btn btn-outline-info")}}
			</div>
		</form>
	</div>
	{% if verses %}

		<div id =  "verse-container" class = "content-section">
			<div class = "row verses">
				{% if is_only_chapter %}
						{% if chapter != 1 %}
							<div class = "col-md-1 prev" id = "home-prev-div">
								<a href = "/verses/chapter?search_param={{book}} {{chapter - 1}}&is_paragraph_mode={{is_paragraph_mode}}" id = "home-prev-link"><i class = "fas fa-chevron-left" data-toggle="tooltip" title="{{book}} {{chapter-1}}"></i></a>	
							</div>
						{% else %}
							<div class = "col-md-1 prev">
							</div>
						{% endif %}
					<div class = "col-md-10 pl-2">
						<h2 class = "mb-3">{{ verses.reference }}</h2>
				{% else %}
					<div class = "col-md-12 pl-2">
						<h2 class = "mb-3">{{ verses.reference }}</h2>
				{% endif %}
					{% if is_paragraph_mode != '1' %}
						{% for verse in verses.verses %}	
							<p><sup class = "mr-1">{{ verse.verse }}</sup>{{ verse.text }}</p>	
						{% endfor %}
					{% else %}
						{% for verse in verses.verses %}
							{% if loop.index % 5 == 0 %}
								<br/><br/>
							{% endif %}
							<span><sup class = "mr-1">{{verse.verse}}</sup>{{verse.text}}</span>
						{% endfor %}
					{% endif %}
					</div>
				{% if is_only_chapter %}
					{% if chapter < num_chapters %}
						<div class = "col-md-1 next pr-2 m-0" id = "home-next-div">
							<a href = "/verses/chapter?search_param={{book}} {{chapter + 1}}&paragraph_mode={{is_paragraph_mode}}" id = "home-next-link" data-toggle="tooltip" title="{{book}} {{chapter+1}}"><i class = "fas fa-chevron-right"></i></a>	
						</div>
					{% else %}
						<div class = "col-md-1 next">
						</div>
					{% endif %}
				{% endif %}
			</div>
		</div>
	{% endif %}
{% endblock content %}

{% block sidebar_content %}
	{% if verses %}
		{% if is_only_chapter %}
			<h3>Options</h3>
			<p class = 'text-muted'> Please choose how you would like the text to be displayed </p>
			{% set search_p = book + chapter|string %}
			<div class = "form-group">
				<div class = "form-check">
					{% if is_paragraph_mode == '1' %}
						<input id = "paragraph-mode" class = "form-check-input" name = "paragraph_mode" type = "checkbox" value = '1' checked> 
					{% else %}
						<input id = "paragraph-mode" class = "form-check-input" name = "paragraph_mode" type = "checkbox" value = '1'> 
					{% endif %}
					<label class = "form-check-label" for = "paragraph"> Paragraph Mode </label>
				</div>
			</div>
			<div class = "form-group">
				<button id = "preference-submit" class = "btn btn-outline-info">Submit</button>	
			</div>
		{% endif %}
	<textarea class = "form-control"></textarea>
	{% endif %}
{% endblock sidebar_content %}

